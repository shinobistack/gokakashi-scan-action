name: gokakashi Action

on:
  workflow_dispatch:
    inputs:
      gokakashi_version:
        description: 'gokakashi version'
        required: false
        default: 'v0.1.0'
      image:
        description: 'Container image to scan'
        required: true
      policy:
        description: 'Policy for the scan'
        required: true
      server:
        description: 'Server'
        required: true
      interval:
        description: 'Interval in seconds to check the scan status (default: 10).'
        required: false
        default: 10
      retries:
        description: 'Number of retries before failing the build (default: 10).'
        required: false
        default: 10

jobs:
  scan:
    runs-on: ubuntu-latest

    steps:
      - name: Run goKakashi Scan Action
        uses: shinobistack/gokakashi-scan-action@v0.1.0
        with:
          image: ${{ github.event.inputs.image }}
          policy: ${{ github.event.inputs.policy }}
          server: ${{ github.event.inputs.server }}
          token: ${{ secrets.GOKAKASHI_API_TOKEN }}
